# ============================================================================
# NEURECTOMY - Azure Key Vault ClusterSecretStore
# Production configuration for AKS with Workload Identity
# ============================================================================

---
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: azure-key-vault
  labels:
    app.kubernetes.io/name: external-secrets
    app.kubernetes.io/component: secret-store
    app.kubernetes.io/part-of: neurectomy-platform
spec:
  provider:
    azurekv:
      # Azure tenant ID - update with your tenant
      tenantId: "${AZURE_TENANT_ID}"
      # Key Vault URL - update with your vault name
      vaultUrl: "https://neurectomy-kv.vault.azure.net"
      # Authentication via Workload Identity (recommended for AKS)
      authType: WorkloadIdentity
      serviceAccountRef:
        name: external-secrets-sa
        namespace: external-secrets

---
# Secondary region Key Vault for DR
apiVersion: external-secrets.io/v1beta1
kind: ClusterSecretStore
metadata:
  name: azure-key-vault-dr
  labels:
    app.kubernetes.io/name: external-secrets
    app.kubernetes.io/component: secret-store-dr
    app.kubernetes.io/part-of: neurectomy-platform
spec:
  provider:
    azurekv:
      tenantId: "${AZURE_TENANT_ID}"
      vaultUrl: "https://neurectomy-kv-dr.vault.azure.net"
      authType: WorkloadIdentity
      serviceAccountRef:
        name: external-secrets-sa
        namespace: external-secrets
